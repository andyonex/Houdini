import hou

if hou.selectedNodes():

    # Get the currently selected node
    selected_node = hou.selectedNodes()[0]

    # Get the parent of the selected node
    parent_node = selected_node.parent()

    # Look for the "preview" node in the same location as the selected node        
    if parent_node.node("PREVIEW"):

        preview_node = parent_node.node("PREVIEW")  

    else:

        # Create "preview" since it doesn't exist
        preview_node = parent_node.createNode("null", "PREVIEW")

    # Look for the "merge" in the same location as the selected node    
    if parent_node.node("PREVIEW_INPUT"):

        merge_node = parent_node.node("PREVIEW_INPUT")

    else:

        # Create "preview" since it doesn't exist
        merge_node = parent_node.createNode("object_merge", "PREVIEW_INPUT")

        # connect preview node with merge
        preview_node.setNextInput(merge_node)

    # Apply selected node to merge node parameter
    merge_node.parm("objpath1").set(selected_node.path())

    # Set display flag on preview node
    preview_node.setDisplayFlag(True)

else:
    # Get the current network editor
    editor = hou.ui.paneTabOfType(hou.paneTabType.NetworkEditor)

    # Get the current path
    path = editor.pwd().path()

    # if Preview exists set the display flag to it
    if hou.node(path+"/PREVIEW"):
        hou.node(path+"/PREVIEW").setDisplayFlag(True)
        
